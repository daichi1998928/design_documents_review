# ER図1
## 全体
- 設計する上で考慮されていない点が多く、データベースとして
　足りていない要素が多い。
　（登録した住所の場所に配送したい場合、
  アルバムに複数のディスクが含まれている場合など。）
## 管理人
- 管理人とエンドユーザにリレーションがあるが、
　エンドユーザ毎に管理人をつける必要はあるか。
## エンドユーザ
- 論理削除を考慮していない。
## 決済
- 登録した住所以外の場所に送りたい場合も考慮する。
- 支払い方法を選択するだけならテーブルを分ける必要はない。
## 購入履歴
- PKが何か示されていない。
- 商品情報が変更された場合、商品を購入した時の情報を見ることはできるか。
- 送料が変更された場合、商品が購入された時の送料は確認できるか。
## 商品
- 曲が複数ある場合を考慮していない。
- 一枚のアルバムに複数のディスクがある場合を考慮していない。
- 同じアーティスト、レーベル、ジャンルの商品があった場合、どのように
  取り扱うのか。
- 曲順の管理はどうするか。
## カート
- PKにはそのテーブルのIDが入る。
- 誰がカートに入れたか、というのをどうやって判定するのか。
 # 注意
 * マークダウン形式で記入してください。
 * 全体を通しての指摘事項の場合、テーブル名の部分を「全体」「共通」などとしてください。

 # フィードバック1回目
 [add]→付け加えなければいけないところ
 [fix]→修正が必要なところ
 [comment]→その他コメント（修正ではないけど、確認して欲しいポイントです）
 ## 全体
 - 設計する上で考慮されていない点が多く、データベースとして
 　足りていない要素が多い。
 　（登録した住所の場所に配送したい場合、
   アルバムに複数のディスクが含まれている場合など。）
   [fix]→今回の問題抽出では、足りない部分全てを抽出する必要がある。足りていないテーブル全てについて指摘する必要がある。
 [add]→入荷テーブルがない。
 [add]→受注詳細テーブルがない
 [add]→Railsで自動で作成されるカラム(id, created_at, updated_at)を考慮してない。

 ## 管理人
 - 管理人とエンドユーザにリレーションがあるが、
 　エンドユーザ毎に管理人をつける必要はあるか。
 [add]→商品テーブルとのリレーションは必要か？ 

 ## エンドユーザ
 - 論理削除を考慮していない。

 ## 決済
 - 登録した住所以外の場所に送りたい場合も考慮する。
 [fix]→エンドユーザーテーブルと紐つけされているので、追加でエンドユーザが複数住所情報を持つような構造にすればいい。つまり、これは全体への指摘で「住所テーブル」の追加という指摘と重複する。また、一つの注文情報を保存するために、住所カラムを設けたので、宛名カラムと郵便番号カラムがないのはおかしい。
 - 支払い方法を選択するだけならテーブルを分ける必要はない。
 [fix]→何を指摘しているのか不明。結論として、注文テーブルに当たる、このテーブルは必要。
 [add]→テーブルの命名がおかしい。命名は管理者側の視点で行う。決済するのはエンドユーザ。注文を受けるのが管理者。「注文テーブル」と言った命名がベター。
 [add]→購入日カラムを持っている。これはタイムスタンプで自動生成される、作成時刻と内容が一致するため不要。
 [add]→送料カラムがない。送料をデータとして持っておけば、送料が変更された場合でもコードの修正がへりベター。
 [add]→送料と同様の理由で消費税カラムがあってもいい。
 [add]→一つの注文につき、合計金額が保存できるカラムが必要。
 [add]→カートカラムとのリレーションが存在してしまうと、商品がカートに入った瞬間、注文テーブルに情報が作成されることになってしまう。
 [add]→FKの注文IDとは？

 ## 購入履歴
 - PKが何か示されていない。
 - 商品情報が変更された場合、商品を購入した時の情報を見ることはできるか。
 - 送料が変更された場合、商品が購入された時の送料は確認できるか。
 [fix]→送料のカラムが必要となる箇所は、注文ごとに情報を管理するテーブル。このテーブルは注文された一つ一つの商品の情報を管理するテーブルである。
 [add]→購入した商品について参照するテーブルなので、テーブルの命名を見直す必要あり。
 [add]→購入時の商品の価格を保存するためのカラムが必要。
 [add]→商品ごとの購入数を管理したい。

 ## 商品
 [add]→在庫数カラムとあるが、この値は（入荷数）ー（売上枚数）で算出される値。基本的にデータベースには計算ずみの値ではなく、計算前の値を保存させる。（同時計算による、エラーを防ぐため。）

 ## カート
 - PKにはそのテーブルのIDが入る。
 - 誰がカートに入れたか、というのをどうやって判定するのか。
 - 商品情報が変更された場合、商品を購入した時の情報を見ることはできるか。
 [fix]→商品の購入時点での情報はカートテーブルに残す必要はない。注文テーブルに残るためである。
 [add]→このテーブルの役割はカートの中の商品を一つ一つ参照することであるから、テーブルの命名は「カート内商品」と言った名前がベター。
 [add]→商品テーブルとリレーションを持たせているのであれば、その商品のアーティスト名やジャケット画像、アルバム名などのデータは引っ張ってくることができるので不要。
 [add]→合計金額カラムは計算済みの値なので不要。


## 全体
- 入荷テーブルがない。
- 受注詳細テーブルがない。
- Railsで自動で作成されるカラム(id, created_at, updated_at)を考慮してない。
- 住所テーブルがない。住所には宛名カラムと郵便番号カラムも必要。

## 管理人
- エンドユーザとのリレーションは必要か？
- 商品テーブルとのリレーションは必要か？ 

## エンドユーザ
- 論理削除を考慮していない。

## 決済
- テーブルの命名がおかしい。命名は管理者側の視点で行う。決済するのはエンドユーザ。注文を受けるのが管理者。
 「注文テーブル」と言った命名がベター。
- 購入日カラムを持っている。これはタイムスタンプで自動生成される、作成時刻と内容が一致するため不要。
- 送料カラムがない。送料をデータとして持っておけば、送料が変更された場合でもコードの修正がへりベター。
- 送料と同様の理由で消費税カラムがあってもいい。
- 一つの注文につき、合計金額が保存できるカラムが必要。
- カートカラムとのリレーションが存在してしまうと、商品がカートに入った瞬間、注文テーブルに情報が作成されることになってしまう。
- FKの注文IDとは？

## 購入履歴
- PKが何か示されていない。
- 送料のカラムが必要となる箇所は、注文ごとに情報を管理するテーブル。このテーブルは注文された一つ一つの商品の情報を管理するテーブルである。
- 購入した商品について参照するテーブルなので、テーブルの命名を見直す必要あり。
- 購入時の商品の価格を保存するためのカラムが必要。
- 商品ごとの購入数を管理したい。


## 商品
- 在庫数カラムとあるが、この値は（入荷数）ー（売上枚数）で算出される値。
 基本的にデータベースには計算ずみの値ではなく、計算前の値を保存させる。（同時計算による、エラーを防ぐため。）

## カート
- PKにはそのテーブルのIDが入る。
- 誰がカートに入れたか、というのをどうやって判定するのか。
- このテーブルの役割はカートの中の商品を一つ一つ参照することであるから、テーブルの命名は「カート内商品」と言った名前がベター。
- 商品テーブルとリレーションを持たせているのであれば、その商品のアーティスト名やジャケット画像、アルバム名などのデータは
 引っ張ってくることができるので不要。
- 合計金額カラムは計算済みの値なので不要。


**研修担当レビュー**
<font color="Red">再提出の際はこのレビューを残しておいてください。</font>

# フィードバック2回目

## 決済
- 送付先住所カラムはありますが、宛名と郵便番号は必要ではないですか？

## 商品
- アーティスト名カラムは必要ですか？
- ジャンルカラムは必要ですか？
- レーベルカラムは必要ですか？
- 曲を複数保存したい場合はどうしますか？
- １つの商品にディスクを複数保存したい場合はどうしますか？
- ステータスカラムがなにを意味しているか不明です。

## 全体
- 入荷テーブルがない。
- 受注詳細テーブルがない。
- Railsで自動で作成されるカラム(id, created_at, updated_at)を考慮してない。
- 住所テーブルがない。住所には宛名カラムと郵便番号カラムも必要。

## 管理人
- エンドユーザとのリレーションは必要か？
- 商品テーブルとのリレーションは必要か？ 

## エンドユーザ
- 論理削除を考慮していない。

## 決済
- テーブルの命名がおかしい。命名は管理者側の視点で行う。決済するのはエンドユーザ。注文を受けるのが管理者。
 「注文テーブル」と言った命名がベター。
- 購入日カラムを持っている。これはタイムスタンプで自動生成される、作成時刻と内容が一致するため不要。
- 送料カラムがない。送料をデータとして持っておけば、送料が変更された場合でもコードの修正がへりベター。
- 送料と同様の理由で消費税カラムがあってもいい。
- 一つの注文につき、合計金額が保存できるカラムが必要。
- カートカラムとのリレーションが存在してしまうと、商品がカートに入った瞬間、注文テーブルに情報が作成されることになってしまう。
- FKの注文IDとは？
- 送付先住所カラムはありますが、宛名と郵便番号は必要ではないですか？

## 購入履歴
- PKが何か示されていない。
- 送料のカラムが必要となる箇所は、注文ごとに情報を管理するテーブル。このテーブルは注文された一つ一つの商品の情報を管理するテーブルである。
- 購入した商品について参照するテーブルなので、テーブルの命名を見直す必要あり。
- 購入時の商品の価格を保存するためのカラムが必要。
- 商品ごとの購入数を管理したい。


## 商品
- 在庫数カラムとあるが、この値は（入荷数）ー（売上枚数）で算出される値。
 基本的にデータベースには計算ずみの値ではなく、計算前の値を保存させる。（同時計算による、エラーを防ぐため。）
- アーティスト名カラムは必要ですか？
- ジャンルカラムは必要ですか？
- レーベルカラムは必要ですか？
- 曲を複数保存したい場合はどうしますか？
- １つの商品にディスクを複数保存したい場合はどうしますか？
- ステータスカラムがなにを意味しているか不明です。

## カート
- PKにはそのテーブルのIDが入る。
- 誰がカートに入れたか、というのをどうやって判定するのか。
- このテーブルの役割はカートの中の商品を一つ一つ参照することであるから、テーブルの命名は「カート内商品」と言った名前がベター。
- 商品テーブルとリレーションを持たせているのであれば、その商品のアーティスト名やジャケット画像、アルバム名などのデータは
 引っ張ってくることができるので不要。
- 合計金額カラムは計算済みの値なので不要。
